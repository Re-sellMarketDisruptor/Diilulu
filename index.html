<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y2K Shop</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* --- CORE STYLES --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding-bottom: 90px; color: #111; }

        /* --- TOP BAR --- */
        .top-bar {
            position: sticky; top: 0; background: #fff; padding: 15px;
            border-bottom: 1px solid #ddd; display: flex; align-items: center; gap: 10px; z-index: 100;
        }
        .search-input {
            width: 100%; padding: 10px 10px 10px 35px; border-radius: 4px; border: 1px solid #ccc;
            background-color: #f9f9f9; font-size: 14px;
        }
        .search-icon { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #888; }
        .cart-btn { position: relative; font-size: 20px; color: #333; text-decoration: none; padding: 5px; }

        /* --- PRODUCT GRID (HOME) --- */
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
        .product-card {
            background: #fff; border-radius: 4px; overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); cursor: pointer;
        }
        .product-image { width: 100%; height: 200px; object-fit: cover; background: #eee; }
        .product-info { padding: 10px; }
        .brand { font-size: 11px; color: #666; margin-bottom: 2px; }
        .price { font-weight: bold; color: #111; font-size: 15px; }

        /* --- NEW: VINTED-STYLE PRODUCT PAGE --- */
        #product-page {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 500; overflow-y: auto; padding-bottom: 100px;
        }
        
        /* The Header (Back Arrow + Share) */
        .app-header {
            position: absolute; top: 0; width: 100%; padding: 15px;
            display: flex; justify-content: space-between; z-index: 10;
        }
        .icon-btn { 
            background: rgba(0,0,0,0.3); color: white; border-radius: 50%; 
            width: 35px; height: 35px; display: flex; align-items: center; justify-content: center;
            text-decoration: none; backdrop-filter: blur(4px);
        }

        /* Image Area container */
        .image-container { position: relative; width: 100%; height: 400px; background: #000; }
        
        .carousel {
            display: flex; overflow-x: auto; scroll-snap-type: x mandatory;
            width: 100%; height: 100%;
        }
        .carousel img {
            min-width: 100%; height: 100%; object-fit: cover; scroll-snap-align: center;
        }

        /* THE GLOSSY HEART (Overlay) */
        .floating-heart {
            position: absolute; bottom: 15px; right: 15px;
            width: 45px; height: 45px;
            background-size: contain; background-repeat: no-repeat; background-position: center;
            filter: grayscale(100%); opacity: 0.8; transition: all 0.2s;
            cursor: pointer;
        }
        .floating-heart.active {
            filter: grayscale(0%); opacity: 1; transform: scale(1.1);
        }

        /* Detail Section */
        .detail-section { padding: 15px; border-bottom: 1px solid #eee; }
        .detail-title { font-size: 18px; color: #333; margin-bottom: 5px; }
        .detail-meta { font-size: 14px; color: #666; margin-bottom: 10px; }
        .detail-price { font-size: 22px; font-weight: bold; color: #111; }
        
        .buyer-protection {
            font-size: 13px; color: #00aeb6; /* Teal color from screenshot */
            display: flex; align-items: center; gap: 5px; margin-top: 5px;
        }

        /* BOTTOM ACTION BAR (Split Buttons) */
        .action-bar {
            position: fixed; bottom: 0; left: 0; width: 100%; padding: 10px 15px;
            background: #fff; border-top: 1px solid #ddd; 
            display: flex; gap: 10px; z-index: 600;
        }
        
        .btn-offer {
            flex: 1; padding: 12px; border: 1px solid #00aeb6; background: #fff;
            color: #00aeb6; font-weight: bold; border-radius: 4px; cursor: pointer;
        }
        .btn-buy {
            flex: 1; padding: 12px; border: none; background: #00aeb6;
            color: #fff; font-weight: bold; border-radius: 4px; cursor: pointer;
        }

        /* Bottom Nav (Main Page) */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%; background: #fff; border-top: 1px solid #eee;
            display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; height: 70px;
        }
        .nav-btn { color: #999; text-decoration: none; text-align: center; font-size: 10px; }
        .nav-btn i { font-size: 20px; display: block; margin-bottom: 4px; }
        
    </style>
</head>
<body>

    <div id="main-view">
        <nav class="top-bar">
            <div style="position:relative; flex-grow:1;">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" placeholder="Search items...">
            </div>
        </nav>

        <main class="product-grid" id="shop-container">
            <div style="padding:20px; grid-column:span 2; text-align:center;">Loading Shop...</div>
        </main>

        <nav class="bottom-nav">
            <a href="#" class="nav-btn"><i class="fas fa-home"></i>Home</a>
            <a href="#" class="nav-btn"><i class="fas fa-search"></i>Search</a>
            <a href="#" class="nav-btn"><i class="fas fa-plus-circle"></i>Sell</a>
            <a href="#" class="nav-btn"><i class="fas fa-envelope"></i>Inbox</a>
            <a href="#" class="nav-btn"><i class="fas fa-user"></i>Profile</a>
        </nav>
    </div>

    <div id="product-page">
        
        <div class="app-header">
            <a href="#" onclick="closeProduct()" class="icon-btn"><i class="fas fa-arrow-left"></i></a>
            <a href="#" onclick="shareProduct()" class="icon-btn"><i class="fas fa-ellipsis-h"></i></a>
        </div>

        <div class="image-container">
            <div class="carousel" id="detail-images">
                </div>
            <div class="floating-heart" id="like-trigger" onclick="toggleLike()"></div>
        </div>

        <div class="detail-section">
            <div class="detail-title" id="detail-name">Product Name</div>
            <div class="detail-meta" id="detail-meta">Size M • Brand • Very Good</div>
            
            <div class="detail-price" id="detail-price">$0.00</div>
            <div class="buyer-protection">
                <i class="fas fa-shield-alt"></i> $6.39 Includes Buyer Protection
            </div>
        </div>

        <div class="detail-section">
            <p style="font-size:14px; line-height:1.5; color:#333;" id="detail-desc">Description...</p>
        </div>

        <div class="action-bar">
            <button class="btn-offer">Make an offer</button>
            <button class="btn-buy" onclick="alert('Opening checkout...')">Buy now</button>
        </div>
    </div>

    <script>
        // ==========================================
        // 1. CONFIGURATION
        // ==========================================
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQxSaXfeWcwBFpXFfbJ4lU25jKhR4ORNTbtQphKOUK7YL4JewJ2NzsS6UNf0V89UnzTufpcreBCJUJo/pub?output=csv";
        
        // PASTE THE LINK TO YOUR GLOSSY HEART IMAGE HERE:
        const heartImageUrl = "Https://i.imgur.com/bVHkcE7_d.webp?maxwidth=760&fidelity=grand"; 

        // ==========================================
        
        let allProducts = [];
        const container = document.getElementById('shop-container');
        const mainView = document.getElementById('main-view');
        const productPage = document.getElementById('product-page');

        // Apply Heart Image to CSS
        document.getElementById('like-trigger').style.backgroundImage = `url('${heartImageUrl}')`;

        async function loadProducts() {
            if(sheetUrl.includes("PASTE_YOUR")) { renderDummyData(); return; }
            try {
                const response = await fetch(sheetUrl);
                const data = await response.text();
                allProducts = csvToJson(data);
                renderGrid(allProducts);
                checkHash();
            } catch (error) { console.error(error); }
        }

        function csvToJson(csv) {
            const lines = csv.split('\n');
            const result = [];
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i]) continue;
                const row = lines[i].split(','); 
                if(row.length < 2) continue;
                
                result.push({
                    id: i,
                    name: row[0] || "Item",
                    price: (row[1] || "0").replace('$', '').trim(),
                    brand: row[2] || "Brand",
                    image: row[3] || "", 
                    category: row[4] || "Misc",
                    description: row[5] || "No description.",
                    moreImages: row[6] ? row[6].split(';') : [] 
                });
            }
            return result;
        }

        function renderGrid(products) {
            let html = '';
            products.forEach(p => {
                html += `
                    <div class="product-card" onclick="openProduct(${p.id})">
                        <img src="${p.image}" class="product-image" onerror="this.src='https://via.placeholder.com/300'">
                        <div class="product-info">
                            <div class="product-title" style="font-size:13px;">${p.name}</div>
                            <div class="brand">${p.brand}</div>
                            <div class="price">$${p.price}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function openProduct(id) {
            const product = allProducts.find(p => p.id == id);
            if (!product) return;

            window.location.hash = `item-${id}`;

            // Fill Info
            document.getElementById('detail-name').innerText = product.name;
            document.getElementById('detail-price').innerText = '$' + product.price;
            document.getElementById('detail-desc').innerText = product.description;
            document.getElementById('detail-meta').innerText = `${product.brand} • ${product.category}`;

            // Fill Images
            let imagesHtml = `<img src="${product.image}">`;
            if (product.moreImages.length > 0) {
                product.moreImages.forEach(img => {
                    if(img.trim()) imagesHtml += `<img src="${img.trim()}">`;
                });
            }
            document.getElementById('detail-images').innerHTML = imagesHtml;

            // Check Like State
            const isLiked = localStorage.getItem('liked_item_' + id);
            const likeBtn = document.getElementById('like-trigger');
            if(isLiked) likeBtn.classList.add('active');
            else likeBtn.classList.remove('active');

            mainView.style.display = 'none';
            productPage.style.display = 'block';
            window.scrollTo(0,0);
        }

        function closeProduct() {
            window.location.hash = '';
            mainView.style.display = 'block';
            productPage.style.display = 'none';
        }

        function toggleLike() {
            const id = window.location.hash.replace('#item-','');
            const btn = document.getElementById('like-trigger');
            
            if(btn.classList.contains('active')) {
                btn.classList.remove('active');
                localStorage.removeItem('liked_item_' + id);
            } else {
                btn.classList.add('active');
                localStorage.setItem('liked_item_' + id, 'yes');
            }
        }

        function checkHash() {
            const hash = window.location.hash;
            if (hash.startsWith('#item-')) {
                openProduct(hash.replace('#item-', ''));
            } else {
                closeProduct();
            }
        }
        
        window.onhashchange = checkHash;

        function renderDummyData() {
            const dummies = [
                {id:1, name:"Primark Red Shorts", price:"5.42", brand:"Primark", image:"https://via.placeholder.com/300/ff0000/fff?text=Red+Shorts", description:"Super cute red lounge shorts. New with tags.", moreImages:[]}
            ];
            renderGrid(dummies);
        }

        loadProducts();
    </script>
</body>
</html>
